{% extends 'base.html' %}
{% load static %}

{% block title %}ì˜¨ìƒˆë™ë¬¼ì˜ë£Œì„¼í„°-{{ post.title }}{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'css/intro.css' %}">
<link rel="stylesheet" href="{% static 'css/notice.css' %}">
<link rel="stylesheet" href="{% static 'css/notice-detail.css' %}">
<style>
/* ì´ë¯¸ì§€ ë§í¬ ìŠ¤íƒ€ì¼ */
.post-image a {
  display: block;
  transition: opacity 0.3s ease;
}

.post-image a:hover {
  opacity: 0.8;
}

.post-image img {
  cursor: pointer;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  transition: transform 0.3s ease;
}

.post-image a:hover img {
  transform: scale(1.02);
}

/* ë§í¬ê°€ ìˆëŠ” ì´ë¯¸ì§€ì„ì„ ì•Œë ¤ì£¼ëŠ” ì•„ì´ì½˜ */
.post-image a::after {
  content: "ğŸ”—";
  position: absolute;
  top: 10px;
  right: 10px;
  background: rgba(0,0,0,0.7);
  color: white;
  padding: 5px 8px;
  border-radius: 15px;
  font-size: 12px;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.post-image {
  position: relative;
}

.post-image a:hover::after {
  opacity: 1;
}

/* ì¹˜ë£Œì¼€ì´ìŠ¤ ì „ìš© ìŠ¤íƒ€ì¼ */
.case-category {
  display: inline-block;
  background: #4CAF50;
  color: white;
  padding: 4px 12px;
  border-radius: 20px;
  font-size: 14px;
  margin-bottom: 10px;
}
</style>
{% endblock %}

{% block content %}
<!-- ë°°ë„ˆ ì„¹ì…˜ -->
<div class="intro-banner">
  <div class="banner-overlay">
    <div class="banner-content">
      <h2>MEDICAL CASE</h2>
      <h1>ì¹˜ë£Œì¼€ì´ìŠ¤</h1>
    </div>
  </div>
</div>

<!-- ì½˜í…ì¸  ì„¹ì…˜ -->
<div class="detail-container">
  <div class="detail-inner">
    <!-- ë’¤ë¡œê°€ê¸° ë²„íŠ¼ -->
    <div class="back-button">
      <a href="{% url 'cases:list' %}" class="btn-back">
        <i class="back-icon">â†</i>
        ëª©ë¡ìœ¼ë¡œ
      </a>
    </div>
    
    <!-- ê²Œì‹œê¸€ í—¤ë” -->
    <div class="post-header">
      <!-- ì¹˜ë£Œì¼€ì´ìŠ¤ ì¹´í…Œê³ ë¦¬ í‘œì‹œ -->
      {% if post.category %}
      <div class="case-category">{{ post.get_category_display }}</div>
      {% endif %}
      
      <h1 class="post-title">{{ post.title }}</h1>
      
      <div class="post-meta">
        <div class="meta-item">
          <span class="meta-label">ì‘ì„±ì¼</span>
          <span class="meta-value">{{ post.created_at|date:"Y.m.d" }}</span>
        </div>
        {% if post.updated_at != post.created_at %}
        <div class="meta-item">
          <span class="meta-label">ìˆ˜ì •ì¼</span>
          <span class="meta-value">{{ post.updated_at|date:"Y.m.d" }}</span>
        </div>
        {% endif %}
      </div>
    </div>
    
    <!-- ê²Œì‹œê¸€ ë‚´ìš© -->
    <div class="post-content">
      <div class="post-text">
        <!-- CKEditor ì½˜í…ì¸ ì— ì´ë¯¸ì§€ê°€ ì—†ê³  ê¸°ì¡´ image í•„ë“œê°€ ìˆìœ¼ë©´ ë¨¼ì € í‘œì‹œ -->
        {% if post.image and '<img' not in post.content %}
        <div class="post-image-legacy">
          {% if post.image_url %}
            <a href="{{ post.image_url }}" target="_blank" rel="noopener noreferrer" title="í´ë¦­í•˜ì—¬ ë§í¬ë¡œ ì´ë™">
              <img src="{{ post.image.url }}" alt="{{ post.title }}">
            </a>
          {% else %}
            <img src="{{ post.image.url }}" alt="{{ post.title }}">
          {% endif %}
        </div>
        {% endif %}
        
        <!-- CKEditor ì½˜í…ì¸  -->
        {{ post.content|safe }}
      </div>
    </div>
    
    <!-- ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ -->
    <div class="post-navigation">
      {% if prev_post %}
      <div class="post-nav-item prev">
        <span class="post-nav-label">ì´ì „ê¸€</span>
        <a href="{% url 'cases:detail' prev_post.id %}" class="post-nav-title">
          {{ prev_post.title }}
        </a>
      </div>
      {% endif %}
      
      {% if next_post %}
      <div class="post-nav-item next">
        <span class="post-nav-label">ë‹¤ìŒê¸€</span>
        <a href="{% url 'cases:detail' next_post.id %}" class="post-nav-title">
          {{ next_post.title }}
        </a>
      </div>
      {% endif %}
    </div>
    
    <!-- ëª©ë¡ ë²„íŠ¼ -->
    <div class="post-actions">
      <a href="{% url 'cases:list' %}" class="btn-list">ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
  // ì´ë¯¸ì§€ í´ë¦­ ì‹œ ìƒˆì°½ìœ¼ë¡œ ì›ë³¸ ë³´ê¸°
  document.addEventListener('DOMContentLoaded', function() {
    // ëª¨ë“  ì´ë¯¸ì§€ì— í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
    const images = document.querySelectorAll('.post-text img, .post-image img, .post-image-legacy img');
    
    images.forEach(img => {
      // ì´ë¯¸ì§€ì— ì»¤ì„œ í¬ì¸í„° ìŠ¤íƒ€ì¼ ì¶”ê°€
      img.style.cursor = 'pointer';
      
      // í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
      img.addEventListener('click', function(e) {
        // ì´ë¯¸ì§€ê°€ ë§í¬ ì•ˆì— ìˆë‹¤ë©´ ë§í¬ ë™ì‘ ìš°ì„ 
        if (this.parentElement.tagName === 'A') {
          return; // ê¸°ì¡´ ë§í¬ ë™ì‘ ìœ ì§€
        }
        
        // ìƒˆì°½ìœ¼ë¡œ ì›ë³¸ ì´ë¯¸ì§€ ì—´ê¸°
        window.open(this.src, '_blank', 'width=800,height=600,scrollbars=yes,resizable=yes');
      });
      
      // í˜¸ë²„ íš¨ê³¼ ì¶”ê°€
      img.addEventListener('mouseenter', function() {
        this.style.opacity = '0.8';
        this.style.transform = 'scale(1.02)';
      });
      
      img.addEventListener('mouseleave', function() {
        this.style.opacity = '1';
        this.style.transform = 'scale(1)';
      });
    });
  });
</script>
{% endblock %}